<% content_for :title, "#{@provider_config.display_name} - Admin" %>

<div class="px-4 sm:px-6 lg:px-8">
  <%= render "admin/shared/page_header",
      title: @provider_config.display_name,
      description: "#{@provider_config.provider_type.titleize} provider configuration",
      breadcrumbs: [
        { label: "LLM Provider Configs", path: admin_llm_provider_configs_path },
        { label: @provider_config.display_name }
      ],
      actions: render("admin/shared/action_bar", actions: [
        {
          label: "Edit",
          path: edit_admin_llm_provider_config_path(@provider_config),
          style: :primary
        },
        {
          label: "Test Provider",
          path: test_provider_admin_llm_provider_config_path(@provider_config),
          method: :post,
          style: :secondary,
          confirm: "Test this provider configuration?"
        }
      ]) %>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Main Content -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Status -->
      <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
        <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">
          Configuration Status
        </h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Enabled</dt>
            <dd class="mt-1">
              <%= render "admin/shared/status_badge", status: @provider_config.enabled? ? "enabled" : "disabled", custom_colors: {
                "enabled" => "bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",
                "disabled" => "bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300"
              } %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Ready</dt>
            <dd class="mt-1">
              <%= render "admin/shared/status_badge", status: @provider_config.ready? ? "ready" : "not_ready", custom_colors: {
                "ready" => "bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",
                "not_ready" => "bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400"
              } %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">API Key</dt>
            <dd class="mt-1">
              <% if @provider_config.api_key_configured? %>
                <span class="text-sm text-green-600 dark:text-green-400">Configured</span>
              <% else %>
                <span class="text-sm text-red-600 dark:text-red-400">Missing</span>
              <% end %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Priority</dt>
            <dd class="mt-1 text-sm text-slate-900 dark:text-white">
              <%= @provider_config.priority %>
            </dd>
          </div>
        </div>
      </div>

      <!-- Configuration Details -->
      <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
        <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">
          Configuration Details
        </h2>
        <dl class="space-y-4">
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Provider Type</dt>
            <dd class="mt-1 text-sm text-slate-900 dark:text-white">
              <%= @provider_config.provider_type.titleize %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Model</dt>
            <dd class="mt-1 text-sm text-slate-900 dark:text-white font-mono">
              <%= @provider_config.llm_model %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Max Tokens</dt>
            <dd class="mt-1 text-sm text-slate-900 dark:text-white">
              <%= @provider_config.max_tokens || "—" %>
            </dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">Temperature</dt>
            <dd class="mt-1 text-sm text-slate-900 dark:text-white">
              <%= @provider_config.temperature || "—" %>
            </dd>
          </div>
          <% if @provider_config.api_endpoint.present? %>
            <div>
              <dt class="text-sm font-medium text-slate-500 dark:text-slate-400">API Endpoint</dt>
              <dd class="mt-1 text-sm text-slate-900 dark:text-white font-mono">
                <%= @provider_config.api_endpoint %>
              </dd>
            </div>
          <% end %>
        </dl>
      </div>

      <!-- Settings (JSON) -->
      <% if @provider_config.settings.present? && @provider_config.settings.any? %>
        <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
          <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">
            Additional Settings
          </h2>
          <div class="bg-slate-50 dark:bg-slate-900 rounded-lg p-4 overflow-x-auto" data-controller="json-viewer">
            <div class="flex items-center justify-end gap-2 mb-2">
              <button 
                type="button" 
                data-action="click->json-viewer#copy" 
                class="px-2 py-1 text-xs bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-600 dark:text-slate-400 rounded transition-colors"
              >
                Copy
              </button>
            </div>
            <pre data-json-viewer-target="content" class="text-xs text-slate-700 dark:text-slate-300 font-mono whitespace-pre-wrap"><%= JSON.pretty_generate(@provider_config.settings) %></pre>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Sidebar -->
    <div class="space-y-6">
      <%= render "admin/shared/info_card",
          title: "Provider Details",
          data: {
            "Name" => @provider_config.name,
            "Type" => @provider_config.provider_type.titleize,
            "Model" => @provider_config.llm_model,
            "Priority" => @provider_config.priority
          } %>

      <%= render "admin/shared/info_card",
          title: "Timestamps",
          data: {
            "Created" => @provider_config.created_at.strftime("%B %d, %Y at %H:%M"),
            "Updated" => @provider_config.updated_at.strftime("%B %d, %Y at %H:%M")
          } %>
    </div>
  </div>
</div>

