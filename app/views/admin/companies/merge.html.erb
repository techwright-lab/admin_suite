<% content_for :title, "Merge Company - Admin" %>

<div class="px-4 sm:px-6 lg:px-8 max-w-3xl">
  <%= render "admin/shared/page_header",
      title: "Merge Company",
      description: "Move all associated data to another company, then disable the source company.",
      breadcrumbs: [
        { label: "Companies", path: admin_companies_path },
        { label: @company.name, path: admin_company_path(@company) },
        { label: "Merge" }
      ] %>

  <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6">
    <div class="mb-4">
      <p class="text-sm text-slate-600 dark:text-slate-400">
        Source: <span class="font-medium text-slate-900 dark:text-white"><%= @company.name %></span>
      </p>
      <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">
        After merging, the source company will be disabled.
      </p>
    </div>

    <%= form_with url: merge_into_admin_company_path(@company), method: :post, local: true, class: "space-y-6" do |f| %>
      <%= render "shared/autocomplete",
        form: f,
        field_name: :target_company_id,
        label: "Merge into",
        placeholder: "Search or create company...",
        autocomplete_url: autocomplete_companies_path,
        create_url: companies_path,
        modal_id: "company-merge-modal",
        value: @selected_target_company&.id,
        display_value: @selected_target_company&.name,
        required: true,
        help_text: "Pick the company that should remain after the merge",
        wrapper_class: "mb-0" %>

      <div class="flex items-center justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700">
        <%= link_to "Cancel", admin_company_path(@company), class: "px-4 py-2 text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors" %>
        <%= f.submit "Merge", class: "px-4 py-2 bg-amber-500 hover:bg-amber-600 text-white text-sm font-medium rounded-lg transition-colors cursor-pointer", data: { turbo_confirm: "Merge this company? The source will be disabled." } %>
      </div>
    <% end %>
  </div>
</div>
