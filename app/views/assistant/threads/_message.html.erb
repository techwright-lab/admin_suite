<%# locals: message %>
<% is_user = message.role == "user" %>
<div id="<%= dom_id(message) %>" data-role="<%= message.role %>" class="flex <%= is_user ? 'justify-end' : 'justify-start' %> group">
  <div class="<%= is_user ? 'bg-primary-600 text-white' : 'bg-gray-100 dark:bg-gray-800' %> rounded-2xl px-4 py-2.5 max-w-[80%] <%= is_user ? '' : 'text-gray-900 dark:text-gray-100' %>">
    <div class="text-sm leading-relaxed <%= is_user ? '' : 'chat-message-content' %>">
      <%= render_chat_message(message) %>
    </div>
    <div class="<%= is_user ? 'text-white/60' : 'text-gray-400 dark:text-gray-500' %> text-[10px] mt-1 flex items-center gap-2">
      <span><%= time_ago_in_words(message.created_at) %> ago</span>
      <% unless is_user %>
        <button 
          type="button"
          class="opacity-0 group-hover:opacity-100 transition-opacity hover:text-gray-600 dark:hover:text-gray-300"
          data-controller="clipboard"
          data-action="click->clipboard#copy"
          data-clipboard-text-value="<%= message.content.to_s %>"
          title="Copy message"
        >
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
        </button>
      <% end %>
    </div>
  </div>
</div>
