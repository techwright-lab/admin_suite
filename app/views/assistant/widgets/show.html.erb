<turbo-frame id="assistant_widget" class="block h-full">
  <%= turbo_stream_from "assistant_thread_#{@thread.id}" %>

  <div class="h-full flex flex-col bg-white dark:bg-gray-900" data-controller="assistant-widget" data-assistant-widget-thread-id-value="<%= @thread.id %>">
    <!-- Messages Area -->
    <div class="flex-1 overflow-y-auto" data-assistant-widget-target="messagesContainer">
      <div class="px-4 py-4 space-y-4" id="<%= dom_id(@thread, :messages) %>">
        <% if @messages.empty? %>
          <div class="text-center py-12">
            <div class="w-14 h-14 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center mx-auto mb-4">
              <svg class="w-7 h-7 text-primary-600 dark:text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"/>
              </svg>
            </div>
            <p class="text-base font-medium text-gray-900 dark:text-white mb-2">How can I help?</p>
            <p class="text-sm text-gray-500 dark:text-gray-400">Ask about interviews, applications, or career advice</p>
          </div>
        <% else %>
          <% @messages.each do |message| %>
            <%= render "assistant/threads/message", message: message %>
          <% end %>
        <% end %>
      </div>

      <%# Tool action items - use same DOM ID as main chat for broadcast compatibility %>
      <%= render "assistant/threads/tool_proposals", thread: @thread, tool_executions: @tool_proposals %>
      
      <%# Large spacer to allow ChatGPT-style scroll (last message can reach top of viewport) %>
      <div class="min-h-[60vh]"></div>
    </div>

    <!-- Composer -->
    <div class="flex-shrink-0 border-t border-gray-200 dark:border-gray-700 px-4 py-3 bg-gray-50 dark:bg-gray-800">
      <%= render "assistant/threads/composer", thread: @thread %>
    </div>
  </div>
</turbo-frame>
