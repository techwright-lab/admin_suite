<% value = panel_eval(panel.options[:value]) %>
<% color = (panel.options[:color] || :default).to_sym %>
<% subtitle = panel.options[:subtitle] %>
<% trend = panel.options[:trend] %>
<% trend_direction = (panel.options[:trend_direction] || :neutral).to_sym %>
<% variant = (panel.options[:variant] || :default).to_sym %>

<% color_classes = case color
  when :green
    { bg: "bg-gradient-to-br from-green-50 to-green-100",
      border: "border border-green-200",
      text: "text-green-700",
      label: "text-green-600" }
  when :red
    { bg: "bg-gradient-to-br from-red-50 to-red-100",
      border: "border border-red-200",
      text: "text-red-700",
      label: "text-red-600" }
  when :amber
    { bg: "bg-gradient-to-br from-amber-50 to-amber-100",
      border: "border border-amber-200",
      text: "text-amber-700",
      label: "text-amber-600" }
  when :cyan
    { bg: "bg-gradient-to-br from-cyan-50 to-cyan-100",
      border: "border border-cyan-200",
      text: "text-cyan-700",
      label: "text-cyan-600" }
  when :violet
    { bg: "bg-gradient-to-br from-violet-50 to-violet-100",
      border: "border border-violet-200",
      text: "text-violet-700",
      label: "text-violet-600" }
  else
    { bg: "bg-white",
      border: "border border-slate-200",
      text: "text-slate-900",
      label: "text-slate-500" }
end %>

<% if variant == :mini %>
  <div class="<%= color_classes[:bg] %> rounded-xl p-4 <%= color_classes[:border] %>">
    <div class="text-2xl font-bold <%= color_classes[:text] %>"><%= value %></div>
    <div class="text-sm <%= color_classes[:label] %>"><%= panel.title %></div>
  </div>
<% else %>
  <div class="<%= color_classes[:bg] %> rounded-xl p-5 <%= color_classes[:border] %>">
    <div class="flex items-center justify-between">
      <div class="text-3xl font-bold <%= color_classes[:text] %>"><%= value %></div>
      <% if trend.present? %>
        <% trend_class = case trend_direction
          when :up then "text-green-500"
          when :down then "text-red-500"
          else "text-slate-400"
        end %>
        <span class="text-sm font-medium <%= trend_class %>"><%= trend %></span>
      <% end %>
    </div>
    <div class="text-sm <%= color_classes[:label] %> mt-1"><%= panel.title %></div>
    <% if subtitle.present? %>
      <div class="text-xs <%= color_classes[:label] %> mt-1 opacity-75"><%= subtitle %></div>
    <% end %>
  </div>
<% end %>
