<div 
  class="grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-5 gap-4"
  data-controller="kanban-drag"
  data-kanban-drag-url-value="<%= interview_applications_path %>"
>
  <% InterviewApplication::PIPELINE_STAGES.each do |stage| %>
    <div 
      class="flex flex-col min-w-0"
      data-kanban-drag-target="column"
      data-stage="<%= stage %>"
    >
      <!-- Column Header -->
      <div
        class="
          bg-white dark:bg-gray-800 rounded-t-lg border-t border-x
          border-gray-200 dark:border-gray-700 p-4
        "
      >
        <div class="flex items-center justify-between">
          <h3 class="font-semibold text-gray-900 dark:text-white">
            <%= stage.to_s.titleize %>
          </h3>
          <span
            data-count
            class="
              inline-flex items-center justify-center w-6 h-6 text-xs font-medium rounded-full
              <%= case stage
              when :applied then 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'
              when :screening then 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400'
              when :interviewing then 'bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400'
              when :offer then 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400'
              when :closed then 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'
              end %>
            "
          >
            <%= @applications_by_pipeline_stage[stage]&.count || 0 %>
          </span>
        </div>
      </div>

      <!-- Column Content -->
      <div
        data-cards
        class="
          bg-gray-50 dark:bg-gray-900/50 border border-gray-200
          dark:border-gray-700 rounded-b-lg p-2 space-y-2
          transition-all duration-200
          h-[calc(100vh-280px)] overflow-y-auto
        "
      >
        <% applications = @applications_by_pipeline_stage[stage] || [] %>
        <% if applications.any? %>
          <% applications.each do |application| %>
            <%= render "kanban_card", application: application %>
          <% end %>
        <% else %>
          <div class="text-center py-8 text-sm text-gray-500 dark:text-gray-400">
            No applications
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div>
