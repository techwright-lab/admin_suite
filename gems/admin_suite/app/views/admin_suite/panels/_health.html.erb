<% status = (panel_eval(panel.options[:status]) || :unknown).to_sym %>
<% metrics = panel_eval(panel.options[:metrics]) || {} %>

<% status_config = case status
  when :healthy
    { border: "border-green-200 dark:border-green-800/50",
      badge: "bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",
      dot: "bg-green-500 animate-pulse" }
  when :degraded
    { border: "border-amber-200 dark:border-amber-800/50",
      badge: "bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400",
      dot: "bg-amber-500 animate-pulse" }
  when :critical
    { border: "border-red-200 dark:border-red-800/50",
      badge: "bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400",
      dot: "bg-red-500 animate-pulse" }
  else
    { border: "border-slate-200 dark:border-slate-700",
      badge: "bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400",
      dot: "bg-slate-400" }
end %>

<div class="bg-white dark:bg-slate-800 rounded-xl border <%= status_config[:border] %> overflow-hidden lg:col-span-1">
  <div class="px-4 py-3 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between">
    <h3 class="font-semibold text-slate-900 dark:text-white"><%= panel.title %></h3>
    <span class="flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium <%= status_config[:badge] %>">
      <span class="w-2 h-2 rounded-full <%= status_config[:dot] %>"></span>
      <%= status.to_s.humanize %>
    </span>
  </div>

  <% if metrics.present? %>
    <div class="p-4 grid grid-cols-2 gap-3">
      <% metrics.each do |key, val| %>
        <div>
          <div class="text-lg font-semibold text-slate-900 dark:text-white"><%= val %></div>
          <div class="text-xs text-slate-500 dark:text-slate-400"><%= key.to_s.humanize %></div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="p-4 text-sm text-slate-500 dark:text-slate-400">No metrics.</div>
  <% end %>
</div>
